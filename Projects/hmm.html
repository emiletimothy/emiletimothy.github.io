<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<body class="w3-light-grey">
<title>Emile Timothy</title>
<link rel="stylesheet" href="../CSS/prime_stylesheet.css">
<link rel="stylesheet" type="text/css" href="../style.css">  
    <link rel="stylesheet" href="../CSS/oswald.css">
    <link rel="stylesheet" href="../CSS/opensans.css">
    <link rel="stylesheet" href="../CSS/awesomemin.css">
</head> 
  <style>
    h1,h2,h3,h4,h5,h6 {font-family: "Oswald"}
    body {font-family: "Open Sans"}
    html {
      scroll-behavior: smooth;
    }

/* Style the button that is used to open and close the collapsible content */
.collapsible {
  background-color: #000000;
  color: #ffffff;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  outline: 10px white;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.collapsible:after {
  background-color: #000000;
  content: '+'; /* Unicode character for "plus" sign (+) */
  font-size: 13px;
  outline: #000000;
  color: #ffffff;
  float: right;
  margin-left: 5px;
}

.b1-active:after {
  color: #ffffff;
  font-size:10px;
  content: "-"; /* Unicode character for "minus" sign (-) */
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.b1-active, .collapsible:hover {
  background-color: #000000;
}

.content {
  padding: 0 18px;
  color: white;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.2s ease-out;
}

    </style>

<div class="background_image">
<div class="header">
    <div>
        <div style="float: left"><a href="../index.html"><img src="Pictures/icons/logo_background_nobackground.png", alt="Main Page", style="width:100px;height:100px";></a></div>
        <div>
            <div id="hed1"><br><h2>Projects</h2></div>
            <div id="hed2"><a href="../index.html"><div class="x"><img src="Pictures/icons/x-mark.png", style="width:30px;height:30px;float:right";><img src="Pictures/icons/x-mark-2.png", class="img-top", style="width:30px;height:30px;float:right";></a></div></div>
        </div>
    </div>
</div>
</div>

<div class="navbar">
  <a href="../index.html">Home</a>
  <a href="../about-me.html">About Me</a>
  <a href="../projects.html" class="active">Projects</a>
  <a href="../blog.html">Blog</a>
  <a href="../talks.html">Talks</a>
  <a href="../outreach.html">Outreach</a>
  <a href="../gallery.html">Gallery</a>
  <a href="../CV.html">CV</a>
  <a href="../contact.html">Contact</a>
</div>

<style>
.centertitleph11 {
  display: block;
  margin-left: auto;
  margin-right: auto;
  text-align: center;
}

.container {
  position: relative;
}


.text {
  background-color: white;
  color: black;
  font-size: 3vw; /* Responsive font size */
  font-weight: bold;
  margin: 0 auto; /* Center the text container */
  padding: 10px;
  width: 70.5%;
  text-align: center; /* Center text */
  position: absolute; /* Position text */
  top: 25%; /* Position text in the middle */
  left: 50%; /* Position text in the middle */
  transform: translate(-50%, -50%); /* Position text in the middle */
  mix-blend-mode: screen; /* This makes the cutout text possible */
  font-family: "Oswald", sans-serif;
  text-shadow: 3px 3px 3px #ababab;
}

/* Style the button that is used to open and close the collapsible content */
.collapsible {
  background-color: #000000;
  color: #ffffff;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  outline: 10px white;
  border: none;
  text-align: center;
  outline: none;
  font-size: 15px;
}

.collapsible:after {
  background-color: #000000;
  content: '+'; /* Unicode character for "plus" sign (+) */
  font-size: 13px;
  outline: #000000;
  color: #ffffff;
  float: right;
  margin-left: 5px;
}

.b1-active:after {
  color: #ffffff;
  font-size:10px;
  content: "-"; /* Unicode character for "minus" sign (-) */
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.b1-active, .collapsible:hover {
  background-color: #000000;
}

.content {
  padding: 0 18px;
  color: black;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.2s ease-out;
}


/* Bottom right text */
.text-block {
  position: absolute;
  bottom: 20px;
  right: 20px;
  background-color: black;
  color: white;
  padding-left: 20px;
  padding-right: 20px;
}

.image-container {
  background-image: url("ProjectPictures/hmm.jpeg"); /* The image used - important! */
  background-size: cover;
  position: relative; /* Needed to position the cutout text in the middle of the image */
  height: 70%; /* Some height */
}
</style>

<div class="image-container">
  <div class="text">Hidden Markov Models to Generate Shakespearean Sonnets</div>
</div>



<div class="w3-row w3-padding">
  <div class="w3-col l7 s12" style="float:none !important; margin:auto; position:relative; z-index:10; margin-top:-10%;">
    <div class="w3-container w3-white w3-margin w3-padding-large">
      <div class="w3">

<p>During the winter quarter of my sophomore year at Caltech, I took CS 155 which is a graduate class on Machine Learning and Data Mining, taught by Professor <a href="http://www.yisongyue.com/">Yisong Yue</a>. One of our last week-long assignments was to individually create a Hidden Markov Model (HMM) using the Viterbi, backpropagation, and feedforward algorithms. Following this, I formed a group with my friends (Andrew, Basel, and Julen), and we used the HMM's we had individually constructed to find the transition and emission matrices of Shakespearean words from a corpus of texts using the CMU Pronouncing Dictionary. We then used the Baum-Welch algorithm, to generate somewhat meaningful Shakespearean sonnets while preserving the stress-unstress syllable pattern invariant. Here, I have showcased some of the sonnets generated by our algorithm, explained (to some technical details) the underlying algorithms involved in these tasks, and embedded the final reports that we presented to the class.<br><br></p></div>


<button class="collapsible centertitleph11"><p5><strong>Showcase: Synthetic Shakespearean Sonnet</strong></p5></button>
  <div class="content">


<br><h5 style="text-align:center;"><u>Sonnet 1</u></h5>

<p style="text-align:center;"><code>

Rather of the touches since torment<br>
Memorial which ride some freezings course<br>
Dost why that not me orient<br>
He writ on my to perforce<br><br>

Have now alone make the fine<br>
Policy follow he they his rude<br>
Verse and so sight thy line<br>
Flatter now out short his food<br><br>

By being you rain our beyond<br>
What dost fair deserving and nights<br>
Ransom on thy offenders being bond<br>
Of the might for sweet light's<br><br>

Do woman's by your excuse towards<br>
Though whom plain should this affords<br></code>


<br><h5 style="text-align:center;"><u>Sonnet 2</u></h5>

<p style="text-align:center;"><code>
Can unto him and mortal gathered hold <br>
Remembered ransom and for do asleep <br>
That ills the how to not did I be fold <br>
The stewards and that stronger are for steep <br><br>

Is of consumed with other not in shine <br>
And poet's you with which to to and pride <br>
In any with to doth and my will nine <br>
For hours is to with the rebel eyed <br><br>

In how in answer smother flatter where <br>
The kind be painting so a master fault <br>
Is is his what and motion as with bear <br>
It I be my a all will to to halt <br><br>


The lusty eyes familiar my the vowed <br>
That a are my a thou to I will loud <br>

</code>


<br><h5 style="text-align:center;"><u>Sonnet 3</u></h5>
<p style="text-align:center;"><code>

Still doth both painted cheek present<br>
Spite my how some bring predict<br>
Glad the it now beseechers pleasant<br>
Earth such o'ercharged cries and pricked<br><br>

Charge or praise ensconce gluttoning attending<br>
I new thou see thy another's<br>
Enmity in she and thee bending<br>
And and that the untrimmed others'<br><br>

In against eye of savour smoke<br>
Your the now and that twice<br>
Hath she although sometime shamefully broke<br>
Thou be at form night devise<br><br>

For hours affairs of to told<br>
Is thy you fiery of fold<br>
</code>


<br><h5 style="text-align:center;"><u>Sonnet 4</u></h5>
<p style="text-align:center;"><code>

Thou art to great with gentle work did frame <br>
The lovely gaze where every eye doth dwell <br>
Will play the tyrants to the very same,<br>
And that unfair which fairly doth excel:<br><br>
For never-resting time leads summer on<br>
To hideous winter and confounds him there,<br>
Sap checked with frost and lusty leaves quite gone,<br>
Beauty o’er-snowed and bareness every where:<br><br>
Then were not summer’s distillation left<br>
A liquid prisoner pent in walls of glass,<br>
Beauty’s effect with beauty were bereft,<br>
Nor it nor no remembrance what it was.<br><br>
But flowers distilled though they with winter meet,<br>
Leese but their show, their substance still lives sweet.<br></code>
</p>



<br><h5 style="text-align:center;"><u>Sonnet 5</u></h5>
<p style="text-align:center;"><code>

I three not as sweet as your alone seeing.<br>
Death's upon comfort of thy sort acquainted<br>
Not never o for mark three is told 'greeing<br>
Let so all this world seem amen attainted<br><br>

Be hours and upon nor again keen <br>
She never what i would you luck to thee<br>
Said i when thou an accident unseen<br>
Who thing felt you thy sweet been down his me<br><br>
How himself i seek yea rank the cloud praise<br>
Up me in strange short a of the back fair<br>
Cloud the be soul doth keep too old time's days<br>
On where created you upon me self air<br><br>

To be give the argument to foiled gems<br>
So edge me secret wilt cannot strange hems<br></code>


<br><h5 style="text-align:center;"><u>Sonnet 6</u></h5>
<p style="text-align:center;"><code>let deep could youth is it <br>
heaven's translate of is you doth <br>
exchanged those prime but kind among <br>
and i it set seems make<br>
men looks canst that so hugely <br>
not forgot my least all time's <br>
hate' lead thee your heart i<br>
which i needs beguiled make crystal<br>
a what jacks the than make<br>
seen my fair knows me what<br>
thee pebbled you distempered deceived sweet<br>
hell see love of hours me<br>
for brought let that eclipse dear<br>
thee so all all so then<br>
</code></p>

</div>

<br>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

<button class="collapsible centertitleph11">Building a Hidden Markov Model</button>
  <div class="content"><br>
Consider the following set-up. It's actually the simplest Hidden Markov Model. It initializes itself to one state (or one vertex), and then stays at itself with probability \(P(A|A)\) or \(P(B|B)\) and transitions to the other vertex with probability \(P(A|B)\) or \(P(B|A)\). In this model, vertex A represents the uniform distribution from \(\{1,...,6\}\), and vertex B represents the uniform distribution from \(\{1,...,4\}\). So, we write that the initial distribution is \(\pi = (\pi_A, \pi_B)\). In real-world applications, the vertices of the Hidden Markov Model are categories that describe how the output of the model evolves over iterations.<br><br>

<img src="ProjectPictures/easyHMM.png" style="width:100%">
The question that the Hidden Markov Model answers is that if you're given an observed sequence upon sampling from this Markov distribution, say \(1,4,3,6,6,4\), can you predict the most likely sequence and what is the probability of this sequence occurring? Finally, for any element in the distribution that could have belonged to either \(A\) or \(B\), for instance any number from \(\{1,2,3,4\}\), what is the probability that the element belonged to \(A\) (and by contrast, \(B\))?<br><br>

These questions are actually well-answered by the Hidden Markov Model algorithms. The most likely sequence, given some observations, is predicted by the <i>Viterbi algorithm</i>, and its corresponding likelihood is determined by the <i>Forward algorithm</i>. Finally, the probability that an element from an observation belonged to a specific 'vertex' can be determined by the <i>Backward algorithm</i>. To explain these solutions (the forward, backward and Viterbi algorithms) better, we develop some essential notation.

$$\alpha^t(i) = \mathbb{P}(\text{observed sequence, ending in state i at w/t})$$
$$\beta^t(i) = \mathbb{P}(\text{observation after t | ending in state i at w/t})$$
$$\delta^t(i) = \max\limits_{\text{observations}}(\mathbb{P}(\text{observation ending in state i at w/t}))$$
Before I continue, there is one natural question to ask: this 2-vertex Hidden Markov Model is pretty cool, but obviously it doesn't capture the complexity of large datasets. So, maybe consider the \(m\)-vertex Hidden Markov Model. Is there even a unique or existing solution for the most likely forecasted sequence given some  predictions? Turns out that the answer to this question is yes! The Hammersley-Clifford Theorem (or the fundamental theorem of random fields) states that the directed graphical model \(V_\Delta(M_D)\) is equal to the image of the parameter space \(\theta\) under the map \(F_D\). Specifically, it states that a probability distribution has a strictly positive mass if and only if it it is a Gibbs random field: its probability density must be factorizable over the cliques (or complete subgraphs) of the graph. The implication of this result is that for all m and for any observed sequence, the \(m\)-vertex Hidden Markov Model has a unique solution for a predicted future sequence, which can be approximated by common algorithmic tools with neat twists.<br><br>

So, first things first, how do we convert knowledge of our observations to knowledge about the hidden variables behind their system? Can we find out which vertex each of these elements came from? Yes again, and that's exactly what the Viterbi algorithm does.
<img src="ProjectPictures/hmmv1.png" style="width:100%"><br>



<img src="ProjectPictures/hmmv2.png" style="width:100%">

<br>

<br><h5 style="text-align:center;"><u>Implementing the Viterbi Algorithm</u></h5>
The Viterbi algorithm first uses the observations to find the path of maximum probability, which is characterized by:
$$ \text{Path} = \theta'_{\sigma_1 \tau_1}\theta_{\sigma_1 \sigma_2} \theta'_{\sigma_2 \tau_2} \theta_{\sigma_2 \sigma_3} \theta'_{\sigma_3 \tau_3} \theta_{\sigma_3 \sigma_4} \theta'_{\sigma_4 \tau_4}$$

<img src="ProjectPictures/viterbimain.png" style="width:100%"><br><br>

Essentially, the Viterbi algorithm seeks to find the \(\arg\max\limits_y P(y|x)\). We can actually write an explicit formula for this value.<br>
$$\begin{aligned}
  \arg\max\limits_y P(y|x) &= \arg\max\limits_y \frac{P(y,x)}{P(x)}\\
  &= \arg\max\limits_y P(y,x) \\
  &= \arg\max\limits_y \log P(x|y) + \log P(y)
\end{aligned}
$$
So, for \(k=1,...,M\), we can use Dynamic Programming to iteratively solve for each \(\log(\hat{Y}^k(Z))\), where Z loops over every possible probability of state, to produce the best \(\hat{Y}^M(Z)\), which is also known as the Mean A Posteriori (MAP) inference. So, the Viterbi algorithm models the pairwise transitions between states. The reason it works is completely justified by the Bayesian principle. For instance, consider a 1st order HMM, characterized by the joint probability distribution
$$
\begin{aligned}
P(x,y) &= P(\text{End}|y^M) \prod\limits_{i=1}^M P(y^i | y^{i-1}) \prod\limits_{i=1}^M P(x^i | y^i) \\
P(x|y) &= \prod\limits_{i=1}^M P(x^i | y^i)
\end{aligned}
$$
Since we know that \(P(y) = P(\text{End}|y^M)\prod\limits_{i=1}^M P(y^i | y^{i-1})\), we can use this characterization to recover the original Bayes' formula, which states that:
$$ P(x|y) = \frac{P(x,y)}{P(y)} $$

So, what is the actual algorithm? Given an input of the observation space \(O = \{o_1, ..., o_N\} \subseteq S\), a state space \(S = \{s_1, ..., s_K\}\), an array of initial possibilities \(\Pi = (\pi_1,...\pi_K)\) such that \(x_1 = s_i\), a sequence of observations \(Y = (y_1, ..., y_T)\) such that \(y_t = o_i\) if the observation at time \(t\) is \(o_i\), a transition matrix \(A\) of size \(K\times K\) such that \(A_{ij}\) stores the transition probability of transiting from state \(s_i\) to state \(s_j\), and an emission matrix \(B\) of size \(K\times N\) such that \(B_{ij}\) stores the probability of observing \(o_j\) from state \(s_i\), the Viterbi algorithm outputs the most likely hidden state sequence \(X = (x_1, ..., x_T)\). Below is the pseudocode from Wikipedia for the general HMM solution, and I've embedded my code for the Viterbi algorithm to generate Shakespearean sonnets in the later sections below.<br>


<img src="ProjectPictures/Viterbi.png" style="width:100%;"></p>

<br><h5 style="text-align:center;"><u>Implementing the Viterbi Forward Algorithm</u></h5>
<p> some text goes here</p>





<br><h5 style="text-align:center;"><u>Implementing the Viterbi Backward Algorithm</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Supervised Learning</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Unsupervised Learning</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Generate Emission</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Probabilities - alpha and beta</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Supervised HMM</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Unsupervised HMM</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Predicting Sequences and Probabilities</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Generating Sample Sentences</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Comments about the Sparsity of the A and O matrix</u></h5>
<p> some text goes here</p>

<br><h5 style="text-align:center;"><u>Visualizations: The Data Wordcloud and How the HMM Transitions between Genres</u></h5>
<p> some text goes here</p>

<!--   <p align="center"><script src="https://gist.github.com/emiletimothy/220a95a143e4b10b387bb86a76d179f3.js"></script></p> -->

</div>

<br>

<button class="collapsible centertitleph11"><strong>Leveraging the HMM to Compose Sonnets</strong></button>
  <div class="content">
<br><h5 style="text-align:center;"><u>Implementing the Viterbi Algorithm</u></h5>

<p> some text goes here</p>
</div>

<br>

<button class="collapsible centertitleph11"><strong>Final Report: Hidden Markov Model</strong></button>
  <div class="content">
<p align="center"><iframe src="https://drive.google.com/file/d/1t-JoaiH_HJ2mWBzK2ENCQW6MiMpIIE2d/preview" width="90%" height="720" allow="autoplay"></iframe>


</div>
<br>

<button class="collapsible centertitleph11"><strong>Final Report: Generating Shakespearean Sonnets</strong></button>
  <div class="content">
<p align="center"><iframe src="https://drive.google.com/file/d/1tlKr3FExPrqcOFQyUPTAzUgiPmn7OWPg/preview" width="90%" height="720" allow="autoplay"></iframe>


</div>
<br>

<button class="collapsible centertitleph11"><strong>Code: Hidden Markov Model</strong></button>
  <div class="content">
<p align="center"><script src="https://gist.github.com/emiletimothy/952384fadc93b772e1ed5067ece2ca9d.js"></script></p>
</div>
<br>
<button class="collapsible centertitleph11"><strong>Code: Generating Shakespearean Sonnets</strong></button>
  <div class="content">
<p align="center"><script src="https://gist.github.com/emiletimothy/feb70d2017efb6522134ed3185c20b52.js"></script></p>
</div>


      </div>
    </div>
  </div>
</div>

<style>
.rectangle {
  height: 8%;
  width: 55%;
  background-color: black;
  margin-left: auto;
  margin-right: auto;
  color: white;
  display: flex;
  justify-content:center;
  align-items: center;
}

    .centertitleph112 {
      display: block;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }

</style>
</head>

<div class="footer">
    <a href="#" class="w3-button w3-white w3-padding-large w3-margin-bottom"><img src="../up_arrow.png", style="width: 25px;height:25px";></i>To the top</a><br>
    <a href=https://www.instagram.com/emiletimothy/><img src="Pictures/icons/instagram-icon.png", alt="Instagram", style="width:25px;height:25px";></a>
    <a href=https://www.linkedin.com/in/emiletimothy/><img src="Pictures/icons/linkedin-icon.png", alt="Linkedin", style="width:25px;height:25px";></a>
    <a href=https://orcid.org/my-orcid?orcid=0000-0003-2893-9469https://orcid.org/my-orcid?orcid=0000-0003-2893-9469/><img src="Pictures/icons/orcid-icon.png", alt="Orcid", style="width:25px;height:25px";></a>
    <a href=https://scholar.google.com/citations?user=nUXwVU8AAAAJ&hl=en/><img src="Pictures/icons/googlescholar-icon.png", alt="Google Scholar", style="width:25px;height:25px";></a>
    <a href=https://github.com/emiletimothy/><img src="../Pictures/icons/github-icon.png", alt="Github Icon", style="width:30px;height:29px";></a><br><br>
<p1 style="color: white"><br><strong>© 2023 by Emile Timothy</strong></p1>
</div>


</body>

</html>

<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("b1-active");
    var content = this.nextElementSibling;
    if (content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    }
  });
}
</script>